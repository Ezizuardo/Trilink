<!doctype html>
<html lang="{{ 'ru' if g.get('lang','ru')=='ru' else 'en' }}" data-theme="{{ theme }}">
<head>
  <meta charset="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/>
  <title>TriLink</title>
  <link rel="stylesheet" href="{{ url_for('static', filename='css/styles.css') }}">
</head>
<body class="body">
<header class="topbar">
  <div class="left">
    <a class="brand" href="{{ url_for('feed') }}"><span class="logo-hex"></span> <strong>TriLink</strong> <span class="tagline">{{ t('tagline') }}</span></a>
  </div>
  <nav class="nav">
    {% if session.get('user_id') %}
      <a class="nav-link" href="{{ url_for('feed') }}">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6h16v2H4zm0 5h16v2H4zm0 5h10v2H4z"/></svg>
        <span>{{ t('feed') }}</span>
      </a>
      <a class="nav-link" href="{{ url_for('profile') }}">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 10c4.42 0 8 2.24 8 5v1H4v-1c0-2.76 3.58-5 8-5Z"/></svg>
        <span>{{ t('profile_title') }}</span>
      </a>
      <a class="nav-link" href="{{ url_for('search') }}">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M11 4a7 7 0 1 1 0 14 7 7 0 0 1 0-14Zm7.71 11.29-3-3-1.42 1.42 3 3a1 1 0 0 0 1.42-1.42Z"/></svg>
        <span>{{ t('search') }}</span>
      </a>
      <a class="nav-link" href="{{ url_for('chat_index') }}">
        <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 5h16v10H7l-3 3V5Zm2 2v6h12V7H6Zm4 9h10l-2.5 2.5L20 21H10Z"/></svg>
        <span>{{ t('chat') }}</span>
      </a>
      <div class="avatar-menu">
        <button class="avatar-button" type="button">
          <img src="{{ avatar_url(current_user()) }}" class="avatar-mini" alt="me">
        </button>
        <div class="dropdown">
          <div class="dropdown-row">
            <span class="dropdown-label">
              <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 4a8 8 0 0 0 0 16 8 8 0 0 0 0-16Zm0 2v12a6 6 0 0 1 0-12Z"/></svg>
              Тема
            </span>
            <label class="theme-toggle small">
              <input id="themeToggleMenu" type="checkbox" {% if theme=='dark' %}checked{% endif %}/>
              <span class="track"><span class="knob"></span></span>
            </label>
          </div>
          <a class="dropdown-link" href="{{ url_for('profile') }}">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 4a4 4 0 1 1 0 8 4 4 0 0 1 0-8Zm0 10c4.42 0 8 2.24 8 5v1H4v-1c0-2.76 3.58-5 8-5Z"/></svg>
            {{ t('profile_title') }}
          </a>
          <a class="dropdown-link" href="{{ url_for('support_redirect') }}" target="_blank" rel="noopener">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 3a9 9 0 0 0-9 9 9 9 0 0 0 4.5 7.78V21l4.13-2.2c.12.01.24.02.37.02a9 9 0 1 0 0-18Zm0 2a7 7 0 1 1 0 14A7 7 0 0 1 12 5Zm-1 3h2v4h-2Zm0 5h2v2h-2Z"/></svg>
            Техподдержка
          </a>
          <a class="dropdown-link" href="https://t.me/ezizkafromag" target="_blank" rel="noopener">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="m3 12 18-7-4 14-6-4-3 3v-5Z"/></svg>
            Telegram
          </a>
          <a class="dropdown-link" href="mailto:eacorp06@gmail.com">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M4 6h16a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2H4a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2Zm0 2v.51l8 4.8 8-4.8V8H4Zm16 9v-6.49l-7.6 4.56a1 1 0 0 1-1 0L4 12.51V17h16Z"/></svg>
            eacorp06@gmail.com
          </a>
          <a class="dropdown-link" href="{{ url_for('logout') }}">
            <svg class="icon" viewBox="0 0 24 24" aria-hidden="true"><path d="M5 4h7v2H7v12h5v2H5a1 1 0 0 1-1-1V5a1 1 0 0 1 1-1Zm11.59 5.59L20 13l-3.41 3.41L15.17 15l1.59-1.59H10v-2h6.76L15.17 9l1.42-1.41Z"/></svg>
            Выйти
          </a>
        </div>
      </div>
    {% else %}
      <a href="{{ url_for('login_single') }}">{{ t('login_title') }}</a>
    {% endif %}
  </nav>
</header>
<main class="container">
  {% with messages = get_flashed_messages(with_categories=true) %}
    {% if messages %}<div class="flash-wrap">{% for cat,msg in messages %}<div class="flash {{cat}}">{{ msg }}</div>{% endfor %}</div>{% endif %}
  {% endwith %}
  {% block content %}{% endblock %}
</main>
<script>const SET_THEME_URL="{{ url_for('set_theme', theme='__') }}";</script>
<script src="{{ url_for('static', filename='js/app.js') }}"></script>
</body>
</html>
